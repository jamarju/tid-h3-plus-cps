<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tidradio H3 Plus - Web CPS</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <h1>Tidradio H3 Plus CPS</h1>
            <span class="firmware-note" title="This software has been tested with H3 Plus firmware v1.0.45">Tested: FW v1.0.45</span>
            <span class="connection-status" id="connectionStatus">Disconnected</span>
        </div>
        <div class="header-actions">
            <button id="btnConnect" class="btn btn-primary">Connect</button>
            <button id="btnRead" class="btn" disabled>Read</button>
            <div class="btn-split">
                <button id="btnWrite" class="btn btn-split-main" disabled>Write</button>
                <button id="btnWriteDropdown" class="btn btn-split-arrow" disabled>â–¾</button>
                <div class="btn-split-menu" id="writeMenu">
                    <button data-mode="all">Write All</button>
                    <button data-mode="settings">Settings Only</button>
                    <button data-mode="channels">Channels Only</button>
                </div>
            </div>
            <div class="separator"></div>
            <button id="btnLoad" class="btn">Load File</button>
            <button id="btnSave" class="btn">Save File</button>
        </div>
    </header>

    <nav class="tabs">
        <button class="tab active" data-tab="channels">Channels</button>
        <button class="tab" data-tab="settings">Settings</button>
        <button class="tab" data-tab="debug">Debug</button>
    </nav>

    <main class="main-content">
        <section id="channelsPanel" class="panel active">
            <div class="grid-toolbar">
                <span class="grid-info">199 Channels | Arrow keys to navigate | Enter to edit | Ctrl+C/V copy/paste | Ctrl+1/2/3 switch tabs</span>
            </div>
            <div class="grid-container disabled" id="gridContainer">
                <div class="panel-disabled-message" id="gridDisabledMessage">Read from radio or load a file to edit channels</div>
                <table class="channel-grid" id="channelGrid">
                    <thead>
                        <tr>
                            <th class="col-ch" data-tip="Channel number (1-199)">CH</th>
                            <th class="col-rxfreq" data-tip="Receive frequency in MHz - the frequency you listen on">RX Freq</th>
                            <th class="col-txfreq" data-tip="Transmit frequency in MHz - the frequency you transmit on (same as RX for simplex)">TX Freq</th>
                            <th class="col-hop" data-tip="Frequency Hopping - enables spread spectrum hopping (both radios must match)">Hop</th>
                            <th class="col-decode" data-tip="RX CTCSS/DCS tone - only opens squelch when this tone is received (privacy code)">Decode(RX)</th>
                            <th class="col-encode" data-tip="TX CTCSS/DCS tone - transmits this tone so others with matching Decode can hear you">Encode(TX)</th>
                            <th class="col-power" data-tip="Transmit power: LOW (~1W) for short range/battery saving, HIGH (~5W) for longer range">Power</th>
                            <th class="col-bw" data-tip="Bandwidth: N=Narrow (12.5kHz) for digital/PMR446, W=Wide (25kHz) for analog amateur">BW</th>
                            <th class="col-busy" data-tip="Busy Channel Lockout - prevents transmitting when channel is in use">Busy</th>
                            <th class="col-pttid" data-tip="PTT ID - sends DTMF identification when you press/release PTT">PTT ID</th>
                            <th class="col-scan" data-tip="Include this channel in scan list when scanning">Scan</th>
                            <th class="col-name" data-tip="Channel name (up to 8 characters) displayed on radio screen">Name</th>
                            <th class="col-scramble" data-tip="Voice scrambling - both radios must have same setting to communicate">Scram</th>
                        </tr>
                    </thead>
                    <tbody id="channelBody">
                    </tbody>
                </table>
            </div>
        </section>

        <section id="settingsPanel" class="panel">
            <div class="settings-container disabled" id="settingsContainer">
                <div class="panel-disabled-message" id="settingsDisabledMessage">Read from radio or load a file to edit settings</div>
                <div class="settings-group">
                    <h3>Display</h3>
                    <div class="setting-row">
                        <label for="display" title="Screen layout: Single shows one channel, Dual shows A+B channels side by side, Classic is legacy style"><span class="setting-index">15</span> Display</label>
                        <select id="display">
                            <option value="0">Single</option>
                            <option value="1">Dual</option>
                            <option value="2">Classic</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="lightControl" title="How long the backlight stays on after pressing a key. Always On uses more battery."><span class="setting-index">12</span> Backlight</label>
                        <select id="lightControl">
                            <option value="0">Always On</option>
                            <option value="1">5S</option>
                            <option value="2">10S</option>
                            <option value="3">15S</option>
                            <option value="4">30S</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="brightness" title="Display brightness level. Higher values use more battery."><span class="setting-index">13</span> Brightness</label>
                        <select id="brightness">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="aChannelDisp" title="What to show for VFO-A: frequency with channel number, or channel name with number"><span class="setting-index">17</span> Display Type-A</label>
                        <select id="aChannelDisp">
                            <option value="0">Freq + Number</option>
                            <option value="1">Name + Number</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="bChannelDisp" title="What to show for VFO-B: frequency with channel number, or channel name with number"><span class="setting-index">18</span> Display Type-B</label>
                        <select id="bChannelDisp">
                            <option value="0">Freq + Number</option>
                            <option value="1">Name + Number</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="menuColor" title="Color theme for the menu interface and highlights"><span class="setting-index">42</span> Menu Color</label>
                        <select id="menuColor">
                            <option value="0">Blue</option>
                            <option value="1">Red</option>
                            <option value="2">Green</option>
                            <option value="3">Yellow</option>
                            <option value="4">Purple</option>
                            <option value="5">Orange</option>
                            <option value="6">Light Blue</option>
                            <option value="7">Cyan</option>
                            <option value="8">Gray</option>
                            <option value="9">Dark Blue</option>
                            <option value="10">Light Green</option>
                            <option value="11">Brown</option>
                            <option value="12">Pink</option>
                            <option value="13">B.Red</option>
                            <option value="14">G.Blue</option>
                            <option value="15">L.Gray</option>
                            <option value="16">LG.Blue</option>
                            <option value="17">LB.Blue</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Audio</h3>
                    <div class="setting-row">
                        <label for="squelchLevel" title="Minimum signal strength to open the speaker. Higher levels require stronger signals - use higher values in noisy environments."><span class="setting-index">01</span> Squelch Level</label>
                        <select id="squelchLevel">
                            <option value="0">OFF</option>
                            <option value="1">Level 1</option>
                            <option value="2">Level 2</option>
                            <option value="3">Level 3</option>
                            <option value="4">Level 4</option>
                            <option value="5">Level 5</option>
                            <option value="6">Level 6</option>
                            <option value="7">Level 7</option>
                            <option value="8">Level 8</option>
                            <option value="9">Level 9</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="voicePrompt" title="Enable spoken voice prompts for menu navigation and channel announcements"><span class="setting-index">11</span> Voice</label>
                        <input type="checkbox" id="voicePrompt">
                    </div>
                    <div class="setting-row">
                        <label for="language" title="Language for voice prompts and menu text"><span class="setting-index">21</span> Language</label>
                        <select id="language">
                            <option value="0">English</option>
                            <option value="1">Chinese</option>
                            <option value="2">Turkish</option>
                            <option value="3">Russian</option>
                            <option value="4">German</option>
                            <option value="5">Spanish</option>
                            <option value="6">Italian</option>
                            <option value="7">French</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="beep" title="Play a beep sound when pressing keypad buttons"><span class="setting-index">07</span> Keypad Beep</label>
                        <input type="checkbox" id="beep">
                    </div>
                    <div class="setting-row">
                        <label for="roger" title="Beep tone transmitted at end of your transmission to signal you're done talking"><span class="setting-index">06</span> Roger Beep</label>
                        <select id="roger">
                            <option value="0">OFF</option>
                            <option value="1">TONE1</option>
                            <option value="2">TONE2</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="micGain" title="Microphone sensitivity. Increase if others say you're too quiet, decrease if you're distorted."><span class="setting-index">33</span> MIC Gain</label>
                        <select id="micGain">
                            <option value="0">00</option>
                            <option value="1">01</option>
                            <option value="2">02</option>
                            <option value="3">03</option>
                            <option value="4">04</option>
                            <option value="5">05</option>
                            <option value="6">06</option>
                            <option value="7">07</option>
                            <option value="8">08</option>
                            <option value="9">09</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Signal</h3>
                    <div class="setting-row">
                        <label for="ste" title="Squelch Tail Elimination - reduces the 'kerchunk' noise burst at the end of received transmissions"><span class="setting-index">23</span> STE</label>
                        <input type="checkbox" id="ste">
                    </div>
                    <div class="setting-row">
                        <label for="toneBurst" title="Brief tone sent at start of transmission to open repeater squelch (for older repeaters)"><span class="setting-index">24</span> Tone Burst</label>
                        <select id="toneBurst">
                            <option value="0">1000Hz</option>
                            <option value="1">1450Hz</option>
                            <option value="2">1750Hz</option>
                            <option value="3">2100Hz</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="talkAround" title="Bypass repeater TX/RX offset to communicate directly on the RX frequency (simplex)"><span class="setting-index">25</span> Talk Around</label>
                        <input type="checkbox" id="talkAround">
                    </div>
                    <div class="setting-row">
                        <label for="fmInterrupt" title="When OFF, incoming calls can interrupt FM radio mode. When ON, FM radio plays uninterrupted."><span class="setting-index">26</span> FM Interrupt</label>
                        <input type="checkbox" id="fmInterrupt">
                    </div>
                </div>

                <div class="settings-group">
                    <h3>TX Settings</h3>
                    <div class="setting-row">
                        <label for="stepFreq" title="Frequency step size when tuning with the dial in VFO mode. 12.5K is standard for most radios."><span class="setting-index">02</span> Step Freq</label>
                        <select id="stepFreq">
                            <option value="0">2.5K</option>
                            <option value="1">5.0K</option>
                            <option value="2">6.25K</option>
                            <option value="3">10K</option>
                            <option value="4">12.5K</option>
                            <option value="5">25K</option>
                            <option value="6">50K</option>
                            <option value="7">0.5K</option>
                            <option value="8">8.33K</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="tot" title="Transmit Over Time - automatically stops transmission after this time limit to prevent accidental long transmissions"><span class="setting-index">05</span> TOT</label>
                        <select id="tot">
                            <option value="0">OFF</option>
                            <option value="1">30S</option>
                            <option value="2">60S</option>
                            <option value="3">90S</option>
                            <option value="4">120S</option>
                            <option value="5">150S</option>
                            <option value="6">180S</option>
                            <option value="7">210S</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="pttDelay" title="Delay before audio is transmitted after pressing PTT. Allows repeater time to open before you speak."><span class="setting-index">20</span> PTT Delay</label>
                        <select id="pttDelay">
                            <option value="0">100ms</option>
                            <option value="1">200ms</option>
                            <option value="2">300ms</option>
                            <option value="3">400ms</option>
                            <option value="4">500ms</option>
                            <option value="5">600ms</option>
                            <option value="6">700ms</option>
                            <option value="7">800ms</option>
                            <option value="8">900ms</option>
                            <option value="9">1000ms</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="modulation" title="Modulation type: FM for most amateur/PMR use, AM for airband receive"><span class="setting-index">38</span> Modulation</label>
                        <select id="modulation">
                            <option value="0">FM</option>
                            <option value="1">AM</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="tx200" title="Enable transmit in 200MHz band (220-225MHz amateur band). Check your license!"><span class="setting-index">39</span> 200Tx</label>
                        <input type="checkbox" id="tx200">
                    </div>
                    <div class="setting-row">
                        <label for="tx350" title="Enable transmit in 350MHz band. Check local regulations!"><span class="setting-index">40</span> 350Tx</label>
                        <input type="checkbox" id="tx350">
                    </div>
                    <div class="setting-row">
                        <label for="tx500" title="Enable transmit in 500MHz band. Check local regulations!"><span class="setting-index">41</span> 500Tx</label>
                        <input type="checkbox" id="tx500">
                    </div>
                </div>

                <div class="settings-group">
                    <h3>VOX</h3>
                    <div class="setting-row">
                        <label for="voxGain" title="Voice-activated transmit sensitivity. Higher levels trigger on quieter sounds. Useful for hands-free operation."><span class="setting-index">03</span> VOX Level</label>
                        <select id="voxGain">
                            <option value="0">OFF</option>
                            <option value="1">Level 1</option>
                            <option value="2">Level 2</option>
                            <option value="3">Level 3</option>
                            <option value="4">Level 4</option>
                            <option value="5">Level 5</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="voxDelay" title="How long the radio keeps transmitting after you stop talking (VOX hang time)"><span class="setting-index">04</span> VOX Delay</label>
                        <select id="voxDelay">
                            <option value="0">1.0S</option>
                            <option value="1">2.0S</option>
                            <option value="2">3.0S</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Scan</h3>
                    <div class="setting-row">
                        <label for="tdr" title="Monitor both VFO-A and VFO-B channels, alternating between them to catch activity on either"><span class="setting-index">10</span> Dual Watch</label>
                        <input type="checkbox" id="tdr">
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Power Save</h3>
                    <div class="setting-row">
                        <label for="save" title="Battery saver duty cycle. Radio sleeps between receive checks. Higher ratios save more battery but may miss quick transmissions."><span class="setting-index">08</span> Power Save</label>
                        <select id="save">
                            <option value="0">OFF</option>
                            <option value="1">Level 1 (1:1)</option>
                            <option value="2">Level 2 (1:2)</option>
                            <option value="3">Level 3 (1:3)</option>
                            <option value="4">Level 4 (1:4)</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="autoLock" title="Automatically lock the keypad to prevent accidental button presses"><span class="setting-index">09</span> Keypad Lock</label>
                        <input type="checkbox" id="autoLock">
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Function Keys</h3>
                    <div class="setting-row">
                        <label for="shortKeyPf1" title="Function assigned to short press of PF1 side button"><span class="setting-index">27</span> PF1 Short</label>
                        <select id="shortKeyPf1" class="key-select"></select>
                    </div>
                    <div class="setting-row">
                        <label for="longKeyPf1" title="Function assigned to long press of PF1 side button"><span class="setting-index">28</span> PF1 Long</label>
                        <select id="longKeyPf1" class="key-select"></select>
                    </div>
                    <div class="setting-row">
                        <label for="shortKeyPf2" title="Function assigned to short press of PF2 side button"><span class="setting-index">29</span> PF2 Short</label>
                        <select id="shortKeyPf2" class="key-select"></select>
                    </div>
                    <div class="setting-row">
                        <label for="longKeyPf2" title="Function assigned to long press of PF2 side button"><span class="setting-index">30</span> PF2 Long</label>
                        <select id="longKeyPf2" class="key-select"></select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Alarm</h3>
                    <div class="setting-row">
                        <label for="alarmMode" title="On Site: local alarm only. TX Alarm: transmits alarm signal to alert others."><span class="setting-index">22</span> Alarm Mode</label>
                        <select id="alarmMode">
                            <option value="0">On Site</option>
                            <option value="2">TX Alarm</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>DTMF</h3>
                    <div class="setting-row">
                        <label for="aniEdit" title="Automatic Number Identification - your radio's 3-digit ID code sent with PTT ID"><span class="setting-index">16</span> ANI-Edit</label>
                        <input type="text" id="aniEdit" maxlength="3" class="text-input" pattern="[0-9]{3}" placeholder="000">
                    </div>
                    <div class="setting-row">
                        <label for="dtmfSideTone" title="Hear DTMF tones in the speaker when sending them"><span class="setting-index">19</span> DTMF Side Tone</label>
                        <input type="checkbox" id="dtmfSideTone">
                    </div>
                    <div class="setting-row">
                        <label for="dtmfSpeed" title="Duration of each DTMF digit when sending. Slower speeds are more reliable but take longer."><span class="setting-index">34</span> DTMF Speed</label>
                        <select id="dtmfSpeed">
                            <option value="0">80ms</option>
                            <option value="1">90ms</option>
                            <option value="2">100ms</option>
                            <option value="3">110ms</option>
                            <option value="4">120ms</option>
                            <option value="5">130ms</option>
                            <option value="6">140ms</option>
                            <option value="7">150ms</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="dDcd" title="Enable DTMF signaling for single call, group call, and other DTMF calling features"><span class="setting-index">35</span> DCD</label>
                        <input type="checkbox" id="dDcd">
                    </div>
                    <div class="setting-row">
                        <label for="dHold" title="DTMF auto-reset time - how long before the DTMF decoder resets after receiving tones"><span class="setting-index">36</span> D-HOLD</label>
                        <select id="dHold">
                            <option value="0">OFF</option>
                            <option value="1">5S</option>
                            <option value="2">10S</option>
                            <option value="3">15S</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="dRsp" title="DTMF call response: NULL=silent, RING=play ring tone, REPLY=ring + 1s call-back, BOTH=ring + call-back"><span class="setting-index">37</span> D-RSP</label>
                        <select id="dRsp">
                            <option value="0">NULL</option>
                            <option value="1">RING</option>
                            <option value="2">REPLY</option>
                            <option value="3">BOTH</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>LED</h3>
                    <div class="setting-row">
                        <label for="breathLed" title="LED breathing effect duration when radio is idle. Creates a pulsing glow. Uses extra battery."><span class="setting-index">32</span> Breath LED</label>
                        <select id="breathLed">
                            <option value="0">OFF</option>
                            <option value="1">5s</option>
                            <option value="2">10s</option>
                            <option value="3">15s</option>
                            <option value="4">30s</option>
                        </select>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Power On Message</h3>
                    <div class="setting-row">
                        <label for="ponmgs" title="What to show on boot: OFF=nothing, MSG=custom messages, Voltage=battery voltage"><span class="setting-index">14</span> PONMGS</label>
                        <select id="ponmgs">
                            <option value="0">OFF</option>
                            <option value="1">MSG</option>
                            <option value="2">Voltage</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <label for="msg1" title="First line of custom power-on message (up to 16 characters)">MSG1</label>
                        <input type="text" id="msg1" maxlength="16" class="text-input">
                    </div>
                    <div class="setting-row">
                        <label for="msg2" title="Second line of custom power-on message (up to 16 characters)">MSG2</label>
                        <input type="text" id="msg2" maxlength="16" class="text-input">
                    </div>
                    <div class="setting-row">
                        <label for="msg3" title="Third line of custom power-on message (up to 16 characters)">MSG3</label>
                        <input type="text" id="msg3" maxlength="16" class="text-input">
                    </div>
                </div>
            </div>
        </section>

        <section id="debugPanel" class="panel">
            <div class="debug-toolbar">
                <span class="debug-info">Memory Dump (16 KB) | <span class="legend-known">Known</span> <span class="legend-unknown">Unknown Data</span> <span class="legend-empty">Empty (0xFF)</span> | Ctrl+1/2/3 switch tabs</span>
            </div>
            <div class="debug-container disabled" id="debugContainer">
                <div class="panel-disabled-message" id="debugDisabledMessage">Read from radio or load a file to view memory</div>
                <div class="hexdump" id="hexdump">
                    <div class="hexdump-placeholder">Read from radio to view memory dump</div>
                </div>
            </div>
        </section>
    </main>

    <footer class="status-bar">
        <span id="statusMessage">Ready</span>
        <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </footer>

    <input type="file" id="fileInput" accept=".h3p" style="display: none;">

    <script src="js/storage.js"></script>
    <script src="js/ble.js"></script>
    <script src="js/grid.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/debug.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
